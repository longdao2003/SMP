<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thông tin người dùng</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
    <link rel="stylesheet" href="../static/css/styles_1.css">
</head>
<body>
    <header>
        <div class="navbar">
            <span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16" style="margin: 0 0 -2 0;">
                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
              </svg>
               <a href="dashboard3_admin.html" style="text-decoration: none; color: aliceblue;"> Trang chủ </a>
            </span>
        </div>
    </header>
    <div class="container">
        <div class="left-content">
            <h2>Thông tin người dùng</h2>
            <form id="user-info">
                <label for="username">Tên người dùng:</label>
                <input type="text" id="username" name="username" placeholder="Nhập tên người dùng" required>
                
                <label for="user_id">Mã người dùng:</label>
                <input type="text" id="user_id" name="user_id" placeholder="Nhập mã người dùng" required>
                
                <label for="dob">Ngày sinh:</label>
                <input type="date" id="dob" name="dob" required>
                
                <label for="phone">Điện thoại:</label>
                <input type="tel" id="phone" name="phone" placeholder="Nhập số điện thoại" required>
                
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="Nhập email" required>
                
                <label for="role">Vai trò:</label>
                <select id="role" name="role" required>
                    <option value="">Chọn vai trò</option>
                    <option value="admin">Admin</option>
                    <option value="giangvien">Giảng viên</option>
                    <option value="sinhvien">Sinh viên</option>
                </select>   
                
                <label for="gender">Giới tính:</label>
                <select id="gender" name="gender" required>
                    <option value="">Chọn giới tính</option>
                    <option value="nam">Nam</option>
                    <option value="nu">Nữ</option>
                </select>
                
                <label for="address">Địa chỉ:</label>
                <input type="text" id="address" name="address" placeholder="Nhập địa chỉ" required>
                
                <label for="status">Trạng thái:</label>
                <input type="text" id="status" name="status" placeholder="Nhập trạng thái" required>
                
                <label for="major">Chuyên ngành:</label>
                <input type="text" id="major" name="major" placeholder="Nhập chuyên ngành" required>
                
                <label for="class">Lớp học:</label>
                <input type="text" id="class" name="class" placeholder="Nhập lớp học" required>

                <button type="button" id="submit-btn" onclick="updateUser()">Cập nhật</button>
            </form>
        </div>

        <div class="right-sidebar">
            <div class="login-box">
                <h3>THÔNG TIN</h3>
                <p>Mã quản trị viên: 2121051396</p>
                <p>Họ và tên: Đinh Thế Tú</p>
                <a href="login.html" class="logout-btn">Đăng xuất</a>
            </div>

            <div class="feature-box">
                <h3>TÍNH NĂNG</h3>
                <ul>
                    <li><a href="quanlynguoidung.html">Quản lý người dùng</a></li>
                    <li><a href="quanlymonhoc.html">Quản lý môn học</a></li>
                    <li><a href="taolichthi.html">Tạo lịch thi</a></li>
                    <li><a href="taolichhoc.html">Tạo lịch học</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const params = new URLSearchParams(window.location.search);
            document.getElementById("username").value = params.get("userName") || "";
            document.getElementById("user_id").value = params.get("userId") || "";
            document.getElementById("role").value = params.get("userRole") || "";
            document.getElementById("dob").value = params.get("dob") || "";
            document.getElementById("phone").value = params.get("phone") || "";
            document.getElementById("email").value = params.get("email") || "";
            document.getElementById("gender").value = params.get("gender") || "";
            document.getElementById("address").value = params.get("address") || "";
            document.getElementById("status").value = params.get("status") || "";
            document.getElementById("major").value = params.get("major") || "";
            document.getElementById("class").value = params.get("class") || "";
        });
    
        function updateUser() {
            const userId = document.getElementById("user_id").value;
            const userName = document.getElementById("username").value;
            const userRole = document.getElementById("role").value;
            const dob = document.getElementById("dob").value;
            const phone = document.getElementById("phone").value;
            const email = document.getElementById("email").value;
            const gender = document.getElementById("gender").value;
            const address = document.getElementById("address").value;
            const status = document.getElementById("status").value;
            const major = document.getElementById("major").value;
            const className = document.getElementById("class").value;

            const savedUsers = JSON.parse(localStorage.getItem("users")) || [];
            const index = savedUsers.findIndex(user => user.userId === userId);

            const updatedUser = { 
                userId, 
                userName, 
                userRole,
                dob,
                phone,
                email,
                gender,
                address,
                status,
                major,
                class: className
            };

            if (index > -1) {
                savedUsers[index] = updatedUser;
            } else {
                savedUsers.push(updatedUser);
            }

            localStorage.setItem("users", JSON.stringify(savedUsers));
            window.location.href = "quanlynguoidung.html";
        }
    </script>
</body>
</html>